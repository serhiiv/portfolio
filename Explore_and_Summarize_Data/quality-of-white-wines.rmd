---
title: "Which chemical properties influence the quality of white wines?"
author: "Serhii Vykaliuk"
output: 
  html_document: 
    keep_md: yes
    theme: cosmo
    toc: yes
    toc_depth: 1
bibliography: refs.bib
---



# Introduction



```{r intro_library, message = FALSE, warning = FALSE, echo = FALSE}
library(knitr)
library(ggplot2)
library(gridExtra)
library(ggthemes)
library(GGally)
library(purrr)
library(reshape2)
library(latex2exp)
library(memisc)
library(dplyr)
library(randomForest)


```



```{r intro_knitr, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.height = 5)
knitr::opts_chunk$set(fig.width = 10)
knitr::opts_chunk$set(fig.align = 'center')
knitr::opts_chunk$set(fig.path = "quality-of-wwite-wines.images/")

```



```{r intro_data}
wine <- read.csv(url(
  "https://s3.amazonaws.com/udacity-hosted-downloads/ud651/wineQualityWhites.csv"))

# wine
# delete column with number of row
wine <- select(wine, -X)
```



This report explores a dataset white wines. This tidy dataset contains 4, 898 
white wines with 11 variables on quantifying the chemical properties of each 
wine. At least three wine experts rated the quality of each wine, providing 
a rating between 0 (very bad) and 10 (very excellent).

This dataset is publicly available for research. The details are described 
in [@CorCer09]. 



```{r intro_structure}
str(wine)
```



Variable quality is an integer, and all other 11 variables are the float.

Input variables (based on physicochemical tests):

1. fixed acidity (tartaric acid - g/dm^3^)
2. volatile acidity (acetic acid - g/dm^3^)
3. citric acid (g/dm^3^)
4. residual sugar (g/dm^3^)
5. chlorides (sodium chloride - g/dm^3^)
6. free sulfur dioxide (mg/dm^3^)
7. total sulfur dioxide (mg/dm^3^)
8. density (g/cm^3^)
9. pH
10. sulphates (potassium sulphate - g/dm^3^)
11. alcohol (% by volume)

Output variable (based on sensory data): 

12. quality (score between 0 and 10)

The `free.sulfur.dioxide` and `total.sulfur.dioxide` measured in 
units mg/dm^3^ and I think I may convert them to g/dm^3^ that 
will lead our variables to one scale.



```{r intro_summary}
kable(t(apply(wine, 2, summary)), caption = 'Summaries of the variables')
```



```{r intro_histograms, fig.height = 5, fig.width = 10}
mdat <- melt(wine[, names(wine)])

ggplot(mdat, aes(value)) + 
    geom_histogram(aes(y = ..density..), bins = 50, fill = 'red4') + 
    geom_density(colour = 'red1') + 
    facet_wrap(~variable, scales = "free") + 
    labs(title = "Histogram and KDE for all variables")

```



The variables `fixed.acidity`, `volatile.acidity`, `citric.acid`, 
`residual.sugar`, `chlorides`, `free.sulfur.dioxide`, `total.sulfur.dioxide` 
and `sulphates` have long rigth tail with many outlets. The source of that 
is them phisical nature and tools for measure.
 


```{r intro_names}
var_name <- names(wine)
var_desc <- c(
  TeX('fixed acidity (tartaric acid - $g/dm^3^$)'), 
  TeX('volatile acidity (acetic acid - $g/dm^3^$)'), 
  TeX('citric acid ($g/dm^3^$)'), 
  TeX('residual sugar ($g/dm^3^$)'), 
  TeX('chlorides (sodium chloride - $g/dm^3^$)'), 
  TeX('free sulfur dioxide ($mg/dm^3^$)'), 
  TeX('total sulfur dioxide ($mg/dm^3^$)'), 
  TeX('density of wine ($g/dm^3^$)'), 
  'pH', 
  TeX('sulphates (potassium sulphate - $g/dm^3^$)'), 
  'alcohol (% by volume)', 
  'quality (score between 0 and 10)'
)

percent <- 99
lq <- (100 - percent) / 200
rq <- 1 - (100 - percent) / 200
```


---



# Univariate Plots Section



### Variable `fixed.acidity`



> fixed.acidity (tartaric acid - g/dm^3^)  : most acids involved with wine 
or fixed or nonvolatile (do not evaporate readily) 
>
> -- [@CorCer09]



```{r uni_fixed.acidity}
name <- 'fixed.acidity'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

g1 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), binwidth = 0.2, 
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(4, 14)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

g2 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), binwidth = 0.1, 
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(limits = c(min_border, max_border), 
                     breaks = seq(5, 9, 0.5)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = paste(c(percent, "% data"), collapse = ""), 
       x = desc)

grid.arrange(g1, g2, ncol = 1, nrow = 2)

```



`r percent`% wines have a `r name`
between `r min_border` g/dm^3^ 
and `r max_border` g/dm^3^ 
with median `r round(median(wine[[name]]), 3)` g/dm^3^ and 
mean `r round(mean(wine[[name]]), 3)` g/dm^3^.



### Variable `volatile.acidity`



> volatile.acidity (acetic acid - g/dm^3^) : the amount of acetic acid in
wine, which at too high of levels can lead to an unpleasant, vinegar taste
>
> -- [@CorCer09]



```{r uni_volatile.acidity}
name <- 'volatile.acidity'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

g1 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 70,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(0.1, 1.1, 0.1)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

g2 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), binwidth = 0.01, 
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(limits = c(min_border, max_border), 
                     breaks = seq(0.1, 1.1, 0.1)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = paste(c(percent, "% data"), collapse = ""), 
       x = desc)

grid.arrange(g1, g2, ncol = 1, nrow = 2)

```



`r percent`% wines have a `r name`
between `r min_border` g/dm^3^ 
and `r max_border` g/dm^3^ 
with median `r round(median(wine[[name]]), 3)` g/dm^3^ and 
mean `r round(mean(wine[[name]]), 3)` g/dm^3^.



### Variable `citric.acid`



> citric.acid (g/dm^3^)  : found in small quantities, citric acid can add 
'freshness' and flavor to wines
>
> -- [@CorCer09]



```{r uni_citric.acid}
name <- 'citric.acid'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

g1 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), binwidth = 0.02, 
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(0.0, 1.6, 0.1)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

g2 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), binwidth = 0.02, 
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(limits = c(min_border, max_border), 
                     breaks = seq(0.0, 0.7, 0.1)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = paste(c(percent, "% data"), collapse = ""), 
       x = desc)

grid.arrange(g1, g2, ncol = 1, nrow = 2)

```



`r percent`% wines have a `r name`
between `r min_border` g/dm^3^ 
and `r max_border` g/dm^3^ 
with median `r round(median(wine[[name]]), 3)` g/dm^3^ and 
mean `r round(mean(wine[[name]]), 3)` g/dm^3^.



We can see two tops in point 0.49 and point 0.74 that may result from 
a commercial process of produce wine. 
([Wikipedia](https://en.wikipedia.org/wiki/Acids_in_wine#Citric_acid))



### Variable `residual.sugar`



> residual.sugar (g/dm^3^)  : the amount of sugar remaining after fermentation
stops, it's rare to find wines with less than 1 gram/liter and wines with 
greater than 45 grams/liter are considered sweet
>
> -- [@CorCer09]



```{r uni_residual.sugar}
name <- 'residual.sugar'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

g1 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 40,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(5, 60, 5), trans = 'identity') + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

g2 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 40,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(limits = c(min_border, max_border), 
                     breaks = c(1, 2, 3, 4, 5, 8, 12, 15, 20),
                     trans = 'log10') + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = paste(c(percent, "% data on a log scale"), collapse = ""), 
       x = desc)

grid.arrange(g1, g2, ncol = 1, nrow = 2)

```



`r percent`% wines have a `r name`
between `r min_border` g/dm^3^ 
and `r max_border` g/dm^3^ 
with median `r round(median(wine[[name]]), 3)` g/dm^3^ and 
mean `r round(mean(wine[[name]]), 3)` g/dm^3^.

If we transform `residual.sugar` by log10, we can see the bimodal distribution
with the peaking near 1.5 and again in segment 8-13.

I created a new variable to classify the wine according to the 
[sugar content](https://en.wikipedia.org/wiki/Sweetness_of_wine#Terms_used_to_indicate_sweetness_of_wine).



| Labels     | Sweetness        |
|------------|------------------|
| Dry        | up to 4 g/l      |
| Medium dry | up to 12 g/l     |
| Medium     | up to 45 g/l     |
| Sweet      | more than 45 g/l |



I made the variable according to the table above.



```{r uni_residual.sugar_2, fig.height = 3, fig.width = 5}
toSweet <- function(quality) {
  ifelse(quality < 4, return('dry'), NA);
  ifelse(quality < 12, return('medium.dry'), NA);
  return('medium')
}

wine['sweetness'] <- factor(mapply(toSweet, wine$residual.sugar), 
                           levels = c('dry', 'medium.dry', 'medium'))

var_name <- c(var_name, 'sweetness')
var_desc <- c(var_desc, 'sweetness of wine')

name <- 'sweetness'
desc <- var_desc[match(name, var_name)]

ggplot(data = wine, aes(x = wine$sweetness)) + 
  geom_bar(colour = 'white', fill = 'red4') + 
  labs(title = "Sweetnes of wine", 
       x = desc)
```



Since in our data, only one sample contains more sugar than 45 g/dm^3^, 
I divided our collection into three classes.



### Variable `chlorides`



> chlorides (sodium chloride - g/dm^3^)  : the amount of salt in the wine
>
> -- [@CorCer09]



```{r uni_chlorides}
name <- 'chlorides'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

g1 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 70,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(0, 0.35, 0.05)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

g2 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 70,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(limits = c(min_border, max_border), 
                     breaks = seq(0, 0.15, 0.05)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = paste(c(percent, "% data"), collapse = ""), 
       x = desc)

grid.arrange(g1, g2, ncol = 1, nrow = 2)

```



`r percent`% wines have a `r name`
between `r min_border` g/dm^3^ 
and `r max_border` g/dm^3^ 
with median `r round(median(wine[[name]]), 3)` g/dm^3^ and 
mean `r round(mean(wine[[name]]), 3)` g/dm^3^.



### Variable `free.sulfur.dioxide`



> free.sulfur.dioxide (mg/dm^3^)  : the free form of SO2 exists in 
equilibrium between molecular SO2 (as a dissolved gas) and bisulfite ion;
it prevents microbial growth and the oxidation of wine
>
> -- [@CorCer09]



I converted the variable `free.sulfur.dioxide` to g/dm^3^.



```{r uni_free.sulfur.dioxide}
wine['free.SO2'] <- wine$free.sulfur.dioxide / 1000

var_name <- c(var_name, 'free.SO2')
var_desc <- c(var_desc, TeX('free sulfur dioxide ($g/dm^3^$)'))

name <- 'free.SO2'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

g1 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 70,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(0, 0.3, 0.1)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

g2 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), binwidth = 0.001,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(limits = c(min_border, max_border),
                     breaks = seq(0, 0.1, 0.01)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = paste(c(percent, "% data"), collapse = ""), 
       x = desc)

grid.arrange(g1, g2, ncol = 1, nrow = 2)

```



`r percent`% wines have a `r name`
between `r min_border` g/dm^3^ 
and `r max_border` g/dm^3^ 
with median `r round(median(wine[[name]]), 3)` g/dm^3^ and 
mean `r round(mean(wine[[name]]), 3)` g/dm^3^.



### Variable `total.sulfur.dioxide`



> total.sulfur.dioxide (mg/dm^3^) : amount of free and bound forms of S02;
in low concentrations, SO2 is mostly undetectable in wine, but at free SO2
concentrations over 50 ppm, SO2 becomes evident in the nose and taste of wine
>
> -- [@CorCer09]



I converted the variable `total.sulfur.dioxide` to g/dm3.

This variable contains free and bound forms of S02. The free form we have
above and I left only the bound component of SO2.



```{r uni_total.sulfur.dioxide}
wine['bound.SO2'] <- wine$total.sulfur.dioxide / 1000 - wine$free.SO2

var_name <- c(var_name, 'bound.SO2')
var_desc <- c(var_desc, TeX('bound sulfur dioxide ($g/dm^3^$)'))

name <- 'bound.SO2'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <-  round(unname(quantile(wine[[name]], c(rq))), 3)

g1 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 70,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(0, 0.3, 0.1)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

g2 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 70,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(limits = c(min_border, max_border), 
                     breaks = seq(0, 0.2, 0.05)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = paste(c(percent, "% data"), collapse = ""), 
       x = desc)

grid.arrange(g1, g2, ncol = 1, nrow = 2)

```



`r percent`% wines have a `r name`
between `r min_border` g/dm^3^ 
and `r max_border` g/dm^3^ 
with median `r round(median(wine[[name]]), 3)` g/dm^3^ and 
mean `r round(mean(wine[[name]]), 3)` g/dm^3^.



Since the minimum of the new variable `bound.SO2` 
is `r round(min(wine[[name]]), 3)` > 0 then it means that in each 
pair `total.sulfur.dioxide - free.sulfur.dioxide > 0` and the transformation
is done correctly.



### Variable `density`



> density (g/cm^3^)   : the density of water is close to that of water
depending on the percent alcohol and sugar content
>
> -- [@CorCer09]



```{r uni_density}
name <- 'density'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

g1 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 70,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(0.99, 1.03, 0.01)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

g2 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 70,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(limits = c(min_border, max_border), 
                     breaks = seq(0.988, 1.001, 0.001)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = paste(c(percent, "% data"), collapse = ""), 
       x = desc)

grid.arrange(g1, g2, ncol = 1, nrow = 2)

```



`r percent`% wines have a `r name`
between `r min_border` g/dm^3^ 
and `r max_border` g/dm^3^ 
with median `r round(median(wine[[name]]), 3)` g/dm^3^ and 
mean `r round(mean(wine[[name]]), 3)` g/dm^3^.



### Variable `pH`



> pH : describes how acidic or basic a wine is on a scale from 0 (very acidic)
to 14 (very basic); most wines are between 3-4 on the pH scale
>
> -- [@CorCer09]



```{r uni_pH, fig.height = 3, fig.width = 10}
name <- 'pH'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <-  round(unname(quantile(wine[[name]], c(rq))), 3)

ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), binwidth = 0.05, 
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(2.8, 3.8, 0.1)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

```



`r percent`% wines have a `r name`
between `r min_border` g/dm^3^ 
and `r max_border` g/dm^3^ 
with median `r round(median(wine[[name]]), 3)` g/dm^3^ and 
mean `r round(mean(wine[[name]]), 3)` g/dm^3^.


Of all the variables considered above, the distribution of `pH` is most
similar to the normal distribution.



### Variable `sulphates`



> sulphates (potassium sulphate - g/dm^3^)  : a wine additive which can
contribute to sulfur dioxide gas (S02) levels, wich acts as an antimicrobial
and antioxidant
>
> -- [@CorCer09]



```{r uni_sulphates, fig.height = 3, fig.width = 10}
name <- 'sulphates'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), binwidth = 0.05, 
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(0.3, 1.0, 0.1)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

```



`r percent`% wines have a `r name`
between `r min_border` g/dm^3^ 
and `r max_border` g/dm^3^ 
with median `r round(median(wine[[name]]), 3)` g/dm^3^ and 
mean `r round(mean(wine[[name]]), 3)` g/dm^3^.



### Variable `alcohol`



> alcohol (% by volume) : the percent alcohol content of the wine
>
> -- [@CorCer09]



```{r uni_alcohol, fig.height = 3, fig.width = 10}
name <- 'alcohol'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), binwidth = 0.1, 
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(8, 14, 0.5)) + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

```



`r percent`% wines have a `r name`
between `r min_border` g/dm^3^ 
and `r max_border` g/dm^3^ 
with median `r round(median(wine[[name]]), 3)` g/dm^3^ and 
mean `r round(mean(wine[[name]]), 3)` g/dm^3^.



### Variable `quality`



> quality (score between 0 and 10)
>
> -- [@CorCer09]



```{r uni_quality}
wine['score'] <- factor(wine$quality)

var_name <- c(var_name, 'score')
var_desc <- c(var_desc, "quality by score")

toQ3 <- function(quality){
  ifelse(quality > 6, return('better'), NA);
  ifelse(quality == 6, return('normal'), NA);
  ifelse(quality < 6, return('worse'), NA)
}

wine['grade'] <- factor(mapply(toQ3, wine$quality), 
                       levels = c('worse', 'normal', 'better'))

var_name <- c(var_name, 'grade')
var_desc <- c(var_desc, "quality by grade")

```



```{r uni_quality_2, fig.height = 5, fig.width = 10}
g1 <- ggplot(data = wine, aes(x = score)) + 
  geom_bar(fill = 'red4') + 
  scale_y_continuous(breaks = c(25, 150, 500, 1000, 1500, 2000), 
                     trans = 'sqrt') + 
  labs(title = "Quality of wine", x = "quality by score")

g2 <- ggplot(data = wine, aes(x = grade)) + 
  geom_bar(fill = 'red4') + 
  scale_y_continuous(breaks = c(25, 150, 500, 1000, 1500, 2000), 
                     trans = 'sqrt') + 
  labs(title = "Grade of wine", x = "quality by grade")

grid.arrange(g1, g2, ncol = 2, nrow = 1)
```


For quality wine, experts used ratings from 3 to 9 (didn't use 0, 1, 2 and 10).
The highest number of wines rated the score number six. I made a new variable
"grade" which have three categories. Wines with score six belong to category
"normal." Wines with scores greater than six belong to category "better"
and other wines have the category "worse."



# Univariate Analysis



### What is the structure of your dataset?



The database contains information on white wines and consists of 4898 
observation with 12 variables. Only one variable 'quality' is ordered 
factor variable with levels from 3 to 9. 

All other variables are physical or chemical characteristics of wine, 
so they all have a positive floating number. The features `fixed.acidity`, 
`volatile.acidity`, `citric.acid`, `chlorides`, `free.sulfur.dioxide`, 
`total.sulfur.dioxide` and `sulphates` have a distribution similar to 
the normal distribution with a long tail at the right part. 
Also, we can see the bimodal distribution of `residual.sugar`
if we use transform by log10.



### What is/are the main feature(s) of interest in your dataset?



The main feature in the data set is the quality of wine because the main 
question is which features influence to the quality?



### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?



I think that the `alcohol`, `residual.sugar`, `pH`, and `density` are most
influence features in this exploration.


### Did you create any new variables from existing variables in the dataset?



I created two new categorical variable `grade` and `sweetness`. I will use 
them in next parts of this investigation.

Also, I created two continuous variable `free.SO2` and `bound.SO2` when 
I transformed `free.sulfur.dioxide` to g/dm^3^ and separated bound part from 
`total.sulfur.dioxide` variable.



### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the \
form of the data? If so, why did you do this?


This dataset is tidy, but two variable have some differences.
The first, `citric.acid` have two peaks in distribution.
The second, the distribution of `residual.sugar` is like distribution of 
Poisson but transform with logarithm give the ability to see 
bimodal distribution.



---



# Bivariate Plots Section



```{r bi_knitr}
knitr::opts_chunk$set(fig.height = 4)
# knitr::opts_chunk$set(fig.width = 10)
```



### Correlation plot by Spearman



The nature of dataset variables is physicochemical and so that density tied
with the amount alcohol and amount salts and acid, so I think that
[correlation of Spearman](http://bit.ly/2i1HztO) is a good choice.




```{r bi_correlation}
continuous_columns <- c("fixed.acidity", "volatile.acidity", "citric.acid", 
                       "residual.sugar", "chlorides", "free.SO2", "bound.SO2", 
                       "density", "pH", "sulphates", "alcohol", "quality")

ggcorr(select(wine, continuous_columns), layout.exp = 5, 
       method = c("everything", "spearman"), 
       geom = "blank", label = TRUE, hjust = 0.85) + 
  geom_point(size = 10, aes(color = coefficient > 0, 
                            alpha = abs(coefficient) > 0.5)) + 
  scale_alpha_manual(values = c("TRUE" = 0.4, "FALSE" = 0)) + 
  guides(color = FALSE, alpha = FALSE) + 
  labs(title = "Correlation by Spearman")

```



In the first part, I analyze relationship variable `quality` with other
features. The second, I analyze variables with absolute correlation
more than 0.5.


### Quality vs `density`, `chlorides`, and `bound.SO2`



```{r bi_quality_vs_density}
name <- 'density'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

quant <- filter(wine, wine[name] >= min_border, wine[name] <= max_border)

p1 <- ggplot(data = quant, aes(x = quant[name], colour = grade)) + 
  geom_density() + 
  labs(title = paste(c("KDE for", name, "by grade"), collapse = " "), 
     x = desc)


p2 <- ggplot(data = quant, aes(x = score, quant[name])) + 
  geom_boxplot(fill = "red4") + 
  labs(title = paste(c("Score for", name), collapse = " "), 
       x = "score", 
       y = desc)

grid.arrange(p1, p2, ncol = 2, nrow = 1)

```



```{r bi_quality_vs_chlorides}
name <- 'chlorides'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
# max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)
max_border <- 0.075

quant <- filter(wine, wine[name] >= min_border, wine[name] <= max_border)

p1 <- ggplot(data = quant, aes(x = quant[name], colour = grade)) + 
  geom_density(alpha = 0.33) + 
  labs(title = paste(c("KDE for", name, "by grade"), collapse = " "), 
     x = desc)


p2 <- ggplot(data = quant, aes(x = score, quant[name])) + 
  geom_boxplot(fill = "red4") + 
  labs(title = paste(c("Score for", name), collapse = " "), 
       x = "score", 
       y = desc)

grid.arrange(p1, p2, ncol = 2, nrow = 1)

```



```{r bi_quality_vs_bound.SO2}
name <- 'bound.SO2'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

quant <- filter(wine, wine[name] >= min_border, wine[name] <= max_border)

p1 <- ggplot(data = quant, aes(x = quant[name], colour = grade)) + 
  geom_density(alpha = 0.33) + 
  labs(title = paste(c("KDE for", name, "by grade"), collapse = " "), 
     x = desc)


p2 <- ggplot(data = quant, aes(x = score, quant[name])) + 
  geom_boxplot(fill = "red4") + 
  labs(title = paste(c("Score for", name), collapse = " "), 
       x = "score", 
       y = desc)

grid.arrange(p1, p2, ncol = 2, nrow = 1, name = 'Test')

```



On this three plots, we can see that kernel density have three different 
tops for different quality of wine and on all box plots for quality 
more than four the `density`, `chlorides`, and `bound.SO2` decrease
for better quality.



### Quality vs `pH` and `alcohol`



```{r bi_quality_vs_pH}
name <- 'pH'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

quant <- filter(wine, wine[name] >= min_border, wine[name] <= max_border)

p1 <- ggplot(data = quant, aes(x = quant[name], colour = grade)) + 
  geom_density(alpha = 0.33) + 
  labs(title = paste(c("KDE for", name, "by grade"), collapse = " "), 
     x = desc)


p2 <- ggplot(data = quant, aes(x = score, quant[name])) + 
  geom_boxplot(fill = "red4") + 
  labs(title = paste(c("Score for", name), collapse = " "), 
       x = "score", 
       y = desc)

grid.arrange(p1, p2, ncol = 2, nrow = 1)

```




```{r bi_quality_vs_alcohol}
name <- 'alcohol'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

quant <- filter(wine, wine[name] >= min_border, wine[name] <= max_border)

p1 <- ggplot(data = quant, aes(x = quant[name], colour = grade)) + 
  geom_density(alpha = 0.33) + 
  labs(title = paste(c("KDE for", name, "by grade"), collapse = " "), 
     x = desc)


p2 <- ggplot(data = quant, aes(x = score, quant[name])) + 
  geom_boxplot(fill = "red4") + 
  labs(title = paste(c("Score for", name), collapse = " "), 
       x = "score", 
       y = desc)

grid.arrange(p1, p2, ncol = 2, nrow = 1)

```



And here the correlation is positive and we can see an increase.



## Jitter plots for variables with correlation > 0.5



```{r bi_density_vs_residual.sugar}
namex <- 'density'
namey <- 'residual.sugar'

descx <- var_desc[match(namex, var_name)]
min_x <- round(unname(quantile(wine[[namex]], c(lq))), 3)
max_x <- round(unname(quantile(wine[[namex]], c(rq))), 3)

descy <- var_desc[match(namey, var_name)]
min_y <- round(unname(quantile(wine[[namey]], c(lq))), 3)
max_y <-  round(unname(quantile(wine[[namey]], c(rq))), 3)

g1 <- ggplot(data = wine, aes(x = wine[namex], y = wine[namey])) + 
  geom_jitter(alpha = .1, colour = 'red4') + 
  geom_smooth(method = 'lm', se = TRUE) + 
  scale_x_continuous(limits = c(min_x, max_x)) + 
  scale_y_continuous(breaks = c(1, 5, 8, 12, 15, 20), 
                     limits = c(min_y, max_y), trans = 'log10') + 
  labs(title = paste(c(namex, "vs", namey), collapse = " "), 
       x = descx, y = descy)


namex2 <- 'density'
namey2 <- 'bound.SO2'

descx2 <- var_desc[match(namex2, var_name)]
min_x2 <- round(unname(quantile(wine[[namex2]], c(lq))), 3)
max_x2 <- round(unname(quantile(wine[[namex2]], c(rq))), 3)

descy2 <- var_desc[match(namey2, var_name)]
min_y2 <- round(unname(quantile(wine[[namey2]], c(lq))), 3)
max_y2 <- round(unname(quantile(wine[[namey2]], c(rq))), 3)

g2 <- ggplot(data = wine, aes(x = wine[namex2], y = wine[namey2])) + 
  geom_jitter(alpha = .1, colour = 'red4') + 
  geom_smooth(method = 'lm', se = TRUE) + 
  scale_x_continuous(limits = c(min_x2, max_x2)) + 
  scale_y_continuous(limits = c(min_y2, max_y2)) + 
  labs(title = paste(c(namex2, "vs", namey2), collapse = " "), 
       x = descx2, y = descy2)

grid.arrange(g1, g2, ncol = 2)

```



```{r bi_density_vs_chlorides, fig.height = 4, fig.width = 5}
namex <- 'density'
namey <- 'chlorides'

descx <- var_desc[match(namex, var_name)]
min_x <- round(unname(quantile(wine[[namex]], c(lq))), 3)
max_x <- round(unname(quantile(wine[[namex]], c(rq))), 3)

descy <- var_desc[match(namey, var_name)]
min_y <- round(unname(quantile(wine[[namey]], c(lq))), 3)
max_y <- round(unname(quantile(wine[[namey]], c(rq))), 3)
max_y <- 0.075

ggplot(data = wine, aes(x = wine[namex], y = wine[namey])) + 
  geom_jitter(alpha = .1, colour = 'red4') + 
  geom_smooth(method = 'lm', se = TRUE) + 
  scale_x_continuous(limits = c(min_x, max_x)) + 
  scale_y_continuous(limits = c(min_y, max_y)) + 
  labs(title = paste(c(namex, "vs", namey), collapse = " "), 
       x = descx, y = descy)

```



In these plots, we can see a positive correlation between `density` and
`residual.sugar`, `bound.SO2`, `chlorides`.



```{r bi_density_vs_alcohol}
namex4 <- 'density'
namey4 <- 'alcohol'

descx4 <- var_desc[match(namex4, var_name)]
min_x4 <- round(unname(quantile(wine[[namex4]], c(lq))), 3)
max_x4 <- round(unname(quantile(wine[[namex4]], c(rq))), 3)

descy4 <- var_desc[match(namey4, var_name)]
min_y4 <- round(unname(quantile(wine[[namey4]], c(lq))), 3)
max_y4 <- round(unname(quantile(wine[[namey4]], c(rq))), 3)

g4 <- ggplot(data = wine, aes(x = wine[namex4], y = wine[namey4])) + 
  geom_jitter(alpha = .1, colour = 'red4') + 
  geom_smooth(method = 'lm', se = TRUE) + 
  scale_x_continuous(limits = c(min_x4, max_x4)) + 
  scale_y_continuous(limits = c(min_y4, max_y4)) + 
  labs(title = paste(c(namex4, "vs", namey4), collapse = " "), 
       x = descx4, y = descy4)


namex <- 'chlorides'
namey <- 'alcohol'

descx <- var_desc[match(namex, var_name)]
min_x <- round(unname(quantile(wine[[namex]], c(lq))), 3)
# max_x <- round(unname(quantile(wine[[namex]], c(rq))), 3)
max_x <- .075

descy <- var_desc[match(namey, var_name)]
min_y <- round(unname(quantile(wine[[namey]], c(lq))), 3)
max_y <- round(unname(quantile(wine[[namey]], c(rq))), 3)

g5 <- ggplot(data = wine, aes(x = wine[namex], y = wine[namey])) + 
  geom_jitter(alpha = .1, colour = 'red4') + 
  geom_smooth(method = 'lm', se = TRUE) + 
  scale_x_continuous(limits = c(min_x, max_x)) + 
  scale_y_continuous(limits = c(min_y, max_y)) + 
  labs(title = paste(c(namex, "vs", namey), collapse = " "), 
       x = descx, y = descy)

grid.arrange(g5, g4, ncol = 2)


```



In these plots, we can see a negative correlation between `alcohol` and
`density`, `chlorides`.



# Bivariate Analysis


### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?


For a wine that has a quality less than four, the relationships between
variables are apparently not followed. But for a quality wine of 5 or more, 
we can observe the tendency to reduce `density`, `chlorides`, and `bound.SO2`
and increase the `pH` and `alcohol` for wine with the best estimates.



### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?



Unlike the `quality` of a wine, other variables have more prominent
relationships with each other. Especially this connection is noticeable
between the `density` on one side and `chlorides`, `residual.sugar` and
`bound.SO2` on the other side. The `density` of wine increases with the
increase in the amount of these substances. But the `density` also depends
on `alcohol` and decreases as it grows. A surprise for me was the negative
dependence of `alcohol` on `chlorides`.



### What was the strongest relationship you found?


I found two strong correlations between `density` and `residual.sugar` and
also between `density` and `alcohol`.


---



# Multivariate Plots Section


```{r multi_plot_1}
wine['alcohol.f'] <- factor(round(wine$alcohol * 2, 0) / 2)

dd2 <- table(wine$alcohol.f, wine$score)
dd2 <- melt(round(apply(dd2, 1, function(x)(x/sum(x))), 3)*100)

ggplot(dd2, aes(Var2, Var1, fill = value, label = value)) + 
  geom_tile(colour = "white") + 
  geom_text(aes(label = value), color = "white") + 
  scale_x_continuous(breaks = seq(8, 14, .5)) + 
  scale_y_continuous(breaks = seq(3, 9)) + 
  labs(x = "Alcohol (%)", 
       y = "Quality by score", 
       title = "Alcohol - Quality heatmap", 
       fill = "%")

```



I have collected in this table in each cell only than wines that have
the appropriate quality and the corresponding percentage of alcohol.
Then I normalized the columns, and the final figures were converted
into percentages.

Now we can observe a particular pattern. For a wine with an alcohol
content of 8 to 9.5, more than 50 percent of the wine has an estimate of 5.
For a wine with an alcohol content of 10 to 12.5, more than 50 percent of
the wine has an estimate of 6. For a wine with an alcohol content of 13 to 14, 
more than 50 percent of the wine has an estimate of 7.



```{r multi_plot_2}
namex <- 'residual.sugar'
namey <- 'density'

descx <- var_desc[match(namex, var_name)]
min_x <- round(unname(quantile(wine[[namex]], c(lq))), 3)
max_x <- round(unname(quantile(wine[[namex]], c(rq))), 3)

descy <- var_desc[match(namey, var_name)]
min_y <- round(unname(quantile(wine[[namey]], c(lq))), 3)
max_y <- round(unname(quantile(wine[[namey]], c(rq))), 3)

ggplot(data = wine, aes(x = wine[namex], y = wine[namey], colour = grade)) + 
  geom_jitter(alpha = .25) + 
  geom_smooth(method = 'lm', se = FALSE) + 
  scale_x_continuous(limits = c(min_x, max_x), trans = 'sqrt', 
                     breaks = seq(1, 20)) + 
  scale_y_continuous(limits = c(min_y, max_y), breaks = seq(.989, .999, .002)) + 
  labs(title = "Grade by residual.sugar and density", x = descx, y = descy)

```



In this plot, we can see how the `quality` of a wine, `density`, and
`residual.sugar` are interrelated. For a `density` of 0.989 to 0.998, we see
that for the same value of the `density` of wine with a better
`grade` contain more `residual.sugar`.



```{r multi_plot_3}
namex <- 'alcohol'
namey <- 'density'

descx <- var_desc[match(namex, var_name)]
min_x <- round(unname(quantile(wine[[namex]], c(lq))), 3)
max_x <- round(unname(quantile(wine[[namex]], c(rq))), 3)

descy <- var_desc[match(namey, var_name)]
min_y <- round(unname(quantile(wine[[namey]], c(lq))), 3)
max_y <- round(unname(quantile(wine[[namey]], c(rq))), 3)

ggplot(data = wine, aes(x = wine[namex], y = wine[namey],
                        colour = sweetness)) + 
  geom_jitter(alpha = .25) + 
  geom_smooth(method = 'lm', se = FALSE) + 
  scale_x_continuous(limits = c(min_x, max_x)) + 
  scale_y_continuous(limits = c(min_y, max_y)) + 
  labs(title = "Sweetness by alcohol and density", x = descx, y = descy)

```



`Alcohol`, `density`, and `residual.sugar` are also interconnected. `Dry` wines
have a lower `density` and contain less `alcohol` than `medium` wines.



These plots suggest that we can build a classification model and use those
variables in our model to predict the quality of the wine. For this,
I took the random forest model. I split the dataset into two parts:
70% for train and 30% for a test.



```{r ml1}
wine.ml <-  select(wine, "alcohol", "density", "bound.SO2",
                   "volatile.acidity", "free.SO2", "residual.sugar",
                   "pH", "chlorides", "citric.acid", "sulphates",
                   "fixed.acidity", "score")

set.seed(42)
alpha <- 0.7 # percentage of training set
inTrain <- sample(1:nrow(wine.ml), alpha * nrow(wine.ml))
wine.train <- wine.ml[inTrain, ]
wine.test <- wine.ml[-inTrain, ]

```



After train our model we can see 32.7% errors.



```{r train_model}
wine.rf <- randomForest(score ~ ., data = wine.train)
print(wine.rf)

```



```{r}
predictions <- predict(wine.rf, wine.test)
table.rf <- table(wine.test$score, predictions)
test.error <- (1 - sum(diag(as.matrix(table.rf))) / sum(table.rf)) * 100

```


On test part we can see `r test.error`% errors.



```{r}
print(wine.rf$importance)
```


Also, we can see which variables are important for our model.


# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?


At this point, we see that wine `score` is mostly related to `alcohol`.
Alcohol, in turn, has a connection with `chlorides` and a strong bond 
with `density`. `Density` is related to `bound.SO2` and has a high
correlation with `residual.sugar`.

In this way, the features most affected by the `quality` of the wine
are `alcohol`, `density`, `chlorides`, `residual.sugar`, and `bound.SO2`.

I created random forest model. I didn't tune any parameters for this model
and didn't try to improve results. I want to see how model use variables
for predict. The rank of variables in the model close to what we
have seen in the plots above.



------



# Final Plots and Summary



### Plot One



```{r final_plot_1, fig.height = 5, fig.width = 10}
name <- 'residual.sugar'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

g1 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 40,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(breaks = seq(5, 60, 5), trans = 'identity') + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = 'all data', 
       x = desc)

g2 <- ggplot(data = wine, aes(x = wine[name])) + 
  geom_histogram(aes(y = ..density..), bins = 40,
                 colour = 'white', fill = 'red4') + 
  geom_density(colour = 'red1') + 
  scale_x_continuous(limits = c(min_border, max_border), 
                     breaks = c(1, 2, 3, 4, 5, 8, 12, 15, 20),
                     trans = 'log10') + 
  labs(title = paste(c("Histogram and KDE for", name), collapse = " "), 
       subtitle = paste(c(percent, "% data on a log scale"), collapse = ""), 
       x = desc)

grid.arrange(g1, g2, ncol = 1, nrow = 2)

```

### Description One



If we transform `residual.sugar` by log10, we can see the bimodal distribution
with the peaking near 1.5 and again in segment 8-13.



### Plot Two



```{r final_plot_2}
name <- 'alcohol'
desc <- var_desc[match(name, var_name)]

min_border <- round(unname(quantile(wine[[name]], c(lq))), 3)
max_border <- round(unname(quantile(wine[[name]], c(rq))), 3)

quant <- filter(wine, wine[name] >= min_border, wine[name] <= max_border)

p1 <- ggplot(data = quant, aes(x = quant[name], colour = grade)) + 
  geom_density(alpha = 0.33) + 
  labs(title = paste(c("KDE for", name, "by grade"), collapse = " "), 
     x = desc)


p2 <- ggplot(data = quant, aes(x = score, quant[name])) + 
  geom_boxplot(fill = "red4") + 
  labs(title = paste(c("Score for", name), collapse = " "), 
       x = "score", 
       y = desc)

grid.arrange(p1, p2, ncol = 2, nrow = 1)


```



### Description Two



The quality of the wine with low ratings equal three or four is probably
influenced by other characteristics, but starting with the assessment 5, 
the correspondence of higher levels of alcohol to the higher grade of
the quality of wine becomes apparent.



### Plot Three



```{r final_plot_3}
namex <- 'residual.sugar'
namey <- 'density'

descx <- var_desc[match(namex, var_name)]
min_x <- round(unname(quantile(wine[[namex]], c(lq))), 3)
max_x <- round(unname(quantile(wine[[namex]], c(rq))), 3)

descy <- var_desc[match(namey, var_name)]
min_y <- round(unname(quantile(wine[[namey]], c(lq))), 3)
max_y <- round(unname(quantile(wine[[namey]], c(rq))), 3)

ggplot(data = wine, aes(x = wine[namex], y = wine[namey], colour = grade)) + 
  geom_jitter(alpha = .25) + 
  geom_smooth(method = 'lm', se = FALSE) + 
  scale_x_continuous(limits = c(min_x, max_x), trans = 'sqrt', 
                     breaks = seq(1, 20)) + 
  scale_y_continuous(limits = c(min_y, max_y), breaks = seq(.989, .999, .002)) + 
  labs(title = "Grade by residual.sugar and density", x = descx, y = descy)

```



### Description Three



In this plot, we can see how the `quality` of a wine, `density`, and
`residual.sugar` are interrelated. For a `density` of 0.989 to 0.998, we see
that for the same value of the `density` of wine with a better
`grade` contain more `residual.sugar`.


------



# Reflection



We explore the dataset with the characteristics of white wines. The dataset
was in tidy condition and my opinion monotonous.

We have a target variable the `quality` of wine that has a categorical
type and the rest of the all variables have continuous types, 
which led to the uniformity of the charts in the data analysis.

We looked at each variable separately. Variables such as `residual.sugar`, 
`citric.acid`, `free.sulfur.dioxide`, and `total.sulfur.dioxideand`
have attracted our attention more than the rest. Then we constructed
a correlation table and examined the relation of our variables in pairs.
Next, we investigated relationships between three variables.

By the physicochemical properties of wine, all variables interact with
each other as components of one fluid. When one component becomes more
or less, the other elements must also be in the corresponding concentrations.
Therefore, it is not surprising that the primary variable, which is most
closely related to other constituents, was `density`.

Unfortunately, in the description of the data, it is not mentioned anywhere
that all the measurements of `density` were made at the same temperature.
This fact could have a significant effect on the results, because 99% wines
have a density between 0.988 and 1.001 g/dm^3^ and it almost coincides with
the range of `density` of water change when temperature fluctuations
[from 4^о^C to 20^о^C](https://www.engineeringtoolbox.com/water-density-specific-weight-d_595.html).

The expected fact is that `quality` of wine depends on the content of
`alcohol`. The surprise was the influence of `chlorides` on the assessment
of wine and the amount of `alcohol` in wine.

Adding new variables such as `sweetness` and `grade` allowed drawing
more quality pictures. I think that for the further use of these data, 
the reduction of `free.sulfur.dioxide` and `total.sulfur.dioxideand` 
to g/dm^3^ will have a more significant impact. 

I think the next step may be to apply machine learning tools to these data.
We can build a classification model. We can test some models and tune
parameters for the appropriate model. And the end we can select
the best model for predict quality of wine on chemical characteristics.

#  Bibliography
